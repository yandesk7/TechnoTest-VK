# üöÄ TechnoTest-VK: –°–∏–Ω—Ç–∞–∫—Å–∏—Å SQL –∏ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

## üìö –í–≤–µ–¥–µ–Ω–∏–µ

–í –¥–∞–Ω–Ω–æ–º –ø—Ä–æ–µ–∫—Ç–µ –º—ã —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º –º–æ–¥—É–ª—å  7, –∫–æ—Ç–æ—Ä—ã–π –≤–∫–ª—é—á–∞–µ—Ç –≤ —Å–µ–±—è —Ä–∞–±–æ—Ç—É —Å SQL –∏ –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö. –û—Å–Ω–æ–≤–Ω–æ–µ –≤–Ω–∏–º–∞–Ω–∏–µ –±—É–¥–µ—Ç —É–¥–µ–ª–µ–Ω–æ –¥–≤—É–º –æ—Å–Ω–æ–≤–Ω—ã–º —Ç–∞–±–ª–∏—Ü–∞–º: `orders` –∏ `products`.

## üìÇ –¢–∞–±–ª–∏—Ü—ã

### üìù –¢–∞–±–ª–∏—Ü–∞ `products`

- `product_id`: –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø—Ä–æ–¥—É–∫—Ç–∞ (–ø–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á).
- `product_name`: –ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–¥—É–∫—Ç–∞.

### üìù –¢–∞–±–ª–∏—Ü–∞ `orders`

- `order_id`: –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∑–∞–∫–∞–∑–∞ (–ø–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á).
- `product_id`: –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø—Ä–æ–¥—É–∫—Ç–∞, —Å–≤—è–∑–∞–Ω–Ω—ã–π —Å –∑–∞–∫–∞–∑–æ–º (–≤–Ω–µ—à–Ω–∏–π –∫–ª—é—á, —Å—Å—ã–ª–∞–µ—Ç—Å—è –Ω–∞ `product_id` –≤ —Ç–∞–±–ª–∏—Ü–µ `products`).
- `quantity`: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–∞–Ω–Ω–æ–≥–æ –ø—Ä–æ–¥—É–∫—Ç–∞.

## üîó –°–≤—è–∑—å –º–µ–∂–¥—É —Ç–∞–±–ª–∏—Ü–∞–º–∏

–°–≤—è–∑—å –º–µ–∂–¥—É —Ç–∞–±–ª–∏—Ü–∞–º–∏ `orders` –∏ `products` —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ —á–µ—Ä–µ–∑ –ø–æ–ª–µ `product_id`, –∫–æ—Ç–æ—Ä–æ–µ —è–≤–ª—è–µ—Ç—Å—è –≤–Ω–µ—à–Ω–∏–º –∫–ª—é—á–æ–º –≤ —Ç–∞–±–ª–∏—Ü–µ `orders` –∏ —Å—Å—ã–ª–∞–µ—Ç—Å—è –Ω–∞ –ø–æ–ª–µ `product_id` –≤ —Ç–∞–±–ª–∏—Ü–µ `products`. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–≤—è–∑—ã–≤–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∑–∞–∫–∞–∑–∞—Ö —Å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–º–∏ –ø—Ä–æ–¥—É–∫—Ç–∞–º–∏.

## üéØ –ó–∞–¥–∞—á–∞ 1

–ù–∞–π—Ç–∏ –ø—Ä–æ–¥—É–∫—Ç —Å –Ω–∞–∏–±–æ–ª—å—à–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –∑–∞–∫–∞–∑–æ–≤.

## üìù –ó–∞–ø—Ä–æ—Å SQL

SELECT products.product_name,
       SUM (quantity),
       orders.product_id
  FROM orders
  JOIN products ON orders.product_id = products.product_id
GROUP BY orders.product_id
order BY SUM (quantity) DESC
LIMIT 1


## üéØ –ó–∞–¥–∞—á–∞ 2

–û–±—â–∞—è –≤—ã—Ä—É—á–∫–∞ —Å —Ç–æ—á–Ω–æ—Å—Ç—å—é –¥–æ  1 –∑–Ω–∞–∫–∞ –ø–µ—Ä–µ–¥ –∑–∞–ø—è—Ç–æ–π.

## üìù –ó–∞–ø—Ä–æ—Å SQL

SELECT ROUND(SUM(price * quantity),  1)  AS total_revenue
  FROM orders
  JOIN products ON orders.product_id = products.product_id;

